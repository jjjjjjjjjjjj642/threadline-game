<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Cooking Game - Character Selection</title>
<style>
body { margin:0; overflow:hidden; background:#111; font-family:Arial; }
#hud {
  position:absolute; top:10px; left:10px;
  color:white; background:rgba(0,0,0,0.7); padding:10px;
}
#charSelect {
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  color:white; background:rgba(0,0,0,0.8);
  padding:20px; text-align:center;
}
#charSelect button { margin:5px; padding:10px 20px; font-size:16px; }
</style>
</head>
<body>

<div id="hud">
Money: $<span id="money">0</span><br>
Held: <span id="held">Nothing</span>
</div>

<div id="charSelect">
<h2>Select Your Character</h2>
<button onclick="selectCharacter('red')">Red Chef</button>
<button onclick="selectCharacter('blue')">Blue Chef</button>
<button onclick="selectCharacter('green')">Green Chef</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

<script>
// ================= SCENE SETUP =================
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x202020);
const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.7));
const sun = new THREE.DirectionalLight(0xffffff,1);
sun.position.set(10,20,10);
scene.add(sun);

// ================= FLOOR =================
const floor = new THREE.Mesh(
  new THREE.BoxGeometry(40,1,40),
  new THREE.MeshStandardMaterial({color:0x555555})
);
floor.position.y=-0.5;
scene.add(floor);

// ================= WALLS =================
function wall(x,y,z,w,h,d,color){
  const wbox = new THREE.Mesh(new THREE.BoxGeometry(w,h,d),
    new THREE.MeshStandardMaterial({color}));
  wbox.position.set(x,y,z);
  scene.add(wbox);
}
wall(0,1.5,-20,40,3,1,0x888888);
wall(0,1.5,20,40,3,1,0x888888);
wall(-20,1.5,0,1,3,40,0x888888);
wall(20,1.5,0,1,3,40,0x888888);

// ================= COUNTERS =================
const counters=[];
function counter(x,z){
  const c = new THREE.Mesh(new THREE.BoxGeometry(4,1,2),
    new THREE.MeshStandardMaterial({color:0x00ff00}));
  c.position.set(x,0.5,z);
  scene.add(c);
  counters.push(c);
}
counter(-10,-10);
counter(10,-10);
counter(-10,10);
counter(10,10);

// ================= INGREDIENTS =================
const ingredients=[];
function ingredient(x,z,name,color){
  const i = new THREE.Mesh(new THREE.BoxGeometry(.7,.7,.7),
    new THREE.MeshStandardMaterial({color}));
  i.position.set(x,1.3,z);
  i.type="ingredient"; i.name=name;
  scene.add(i);
  ingredients.push(i);
}
ingredient(-10,-10,"Meat",0xff4444);
ingredient(10,-10,"Bread",0xffcc66);

// ================= CUSTOMERS =================
const customers=[];
const orders=["Meat","Bread"];
function customer(x,z){
  const c = new THREE.Mesh(new THREE.BoxGeometry(1,2,1),
    new THREE.MeshStandardMaterial({color:0xff0000}));
  c.position.set(x,1,z);
  c.order=orders[Math.floor(Math.random()*orders.length)];
  scene.add(c);
  customers.push(c);

  // order text
  const canvas = document.createElement("canvas");
  canvas.width=256; canvas.height=128;
  const ctx = canvas.getContext("2d");
  ctx.fillStyle="white"; ctx.font="30px Arial";
  ctx.fillText(c.order,40,70);
  const tex = new THREE.CanvasTexture(canvas);
  const sprite = new THREE.Sprite(new THREE.SpriteMaterial({map:tex}));
  sprite.position.set(0,1.6,0); sprite.scale.set(3,1.5,1);
  c.add(sprite);
}
customer(0,0);
customer(-5,5);
customer(5,5);

// ================= PLAYER CHARACTER =================
let player = null;
let held = null;
let money = 0;

function selectCharacter(color){
  player = new THREE.Mesh(
    new THREE.BoxGeometry(1,2,1),
    new THREE.MeshStandardMaterial({color})
  );
  player.position.set(0,1,15);
  scene.add(player);
  camera.position.set(0,3,17);
  document.getElementById("charSelect").style.display="none";
}

// ================= CONTROLS =================
let keys={}, yaw=0;
document.addEventListener("keydown", e=>keys[e.code]=true);
document.addEventListener("keyup", e=>keys[e.code]=false);
document.body.onclick=()=>document.body.requestPointerLock();
document.addEventListener("mousemove", e=>{
  if(document.pointerLockElement){
    yaw -= e.movementX*0.002;
    if(player) player.rotation.y = yaw;
  }
});

// ================= INTERACTION =================
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
window.addEventListener("mousedown", e=>{
  mouse.x = (e.clientX/innerWidth)*2-1;
  mouse.y = -(e.clientY/innerHeight)*2+1;
  raycaster.setFromCamera(mouse, camera);
  const hit = raycaster.intersectObjects(scene.children,true)[0];
  if(!hit) return;
  const o = hit.object;

  // pick ingredient
  if(o.type==="ingredient"){
    held = o.name;
    o.visible=false;
    document.getElementById("held").innerText = held;
  }

  // serve customer
  customers.forEach(c=>{
    if(player && player.position.distanceTo(c.position)<3 && held===c.order){
      money+=10;
      document.getElementById("money").innerText=money;
      held=null;
      document.getElementById("held").innerText="Nothing";
      c.order=orders[Math.floor(Math.random()*orders.length)];
    }
  });
});

// ================= ANIMATE =================
function animate(){
  requestAnimationFrame(animate);

  if(player){
    const v=new THREE.Vector3();
    if(keys.KeyW)v.z-=.2;
    if(keys.KeyS)v.z+=.2;
    if(keys.KeyA)v.x-=.2;
    if(keys.KeyD)v.x+=.2;
    v.applyAxisAngle(new THREE.Vector3(0,1,0), yaw);
    player.posit
